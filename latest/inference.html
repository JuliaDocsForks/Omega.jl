<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Conditional Inference · Omega.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>Omega.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="search.html"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="index.html">Home</a></li><li><a class="toctext" href="basictutorial.html">Basic Tutorial</a></li><li><a class="toctext" href="model.html">Modeling</a></li><li><a class="toctext" href="conditionalindependence.html">(Conditional) Independence</a></li><li class="current"><a class="toctext" href="inference.html">Conditional Inference</a><ul class="internal"><li><a class="toctext" href="#Conditional-Sampling-Algorithms-1">Conditional Sampling Algorithms</a></li><li><a class="toctext" href="#Conditioning-with-cond-1">Conditioning with <code>cond</code></a></li><li><a class="toctext" href="#Conditioning-the-Prior-1">Conditioning the Prior</a></li><li><a class="toctext" href="#Conditions-Propagate-1">Conditions Propagate</a></li></ul></li><li><a class="toctext" href="soft.html">Soft Execution</a></li><li><a class="toctext" href="causal.html">Causal Inference</a></li><li><a class="toctext" href="higher.html">Higher Order Inference</a></li><li><a class="toctext" href="distributions.html">Built-in Distributions</a></li><li><a class="toctext" href="omega.html">Omega</a></li><li><a class="toctext" href="cheatsheet.html">Cheat Sheet</a></li><li><a class="toctext" href="contrib.html">Contribution Guide</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href="inference.html">Conditional Inference</a></li></ul><a class="edit-page" href="https://github.com/zenna/Omega.jl/blob/master/docs/src/inference.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Conditional Inference</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Inference-1" href="#Inference-1">Inference</a></h1><p>The primary purpose of building a probabilistic model is to use it for inference.</p><h2><a class="nav-anchor" id="Conditional-Sampling-Algorithms-1" href="#Conditional-Sampling-Algorithms-1">Conditional Sampling Algorithms</a></h2><p>While there are several kinds of things you would like to know about a conditional distribution (e.g., its mode) currently, all inference algorithms perform conditional sampling only. To sample from a conditional distribution: pass two random variables to <code>rand</code>, the distribution you want to sample from, and the predicate you want to condition on. For example:</p><pre><code class="language-julia">weight = β(2.0, 2.0)
x = bernoulli()
rand(weight, x == 0)</code></pre><p>It is fine to condition random variables on equalities or inequalities:</p><pre><code class="language-julia">x1 = normal(0.0, 1.0)
x2 = normal(0.0, 10)
rand((x1, x2), x1 + x2 &gt; == 0.0)</code></pre><p>Note: to sample from more than one random variable, just pass a tuple of <code>RandVar</code>s to <code>rand</code>, e.g.:</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Base.rand" href="#Base.rand"><code>Base.rand</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Random ω ∈ Ω</p></div></div><a class="source-link" target="_blank" href="https://github.com/zenna/Omega.jl/blob/3d525c4814c9a035ad470e1e252c428b08b91636/src/space/omega.jl#L19">source</a><div><div><p>Sample <code>n</code> from <code>x</code></p></div></div><a class="source-link" target="_blank" href="https://github.com/zenna/Omega.jl/blob/3d525c4814c9a035ad470e1e252c428b08b91636/src/inference/rand.jl#L13">source</a><div><div><p>Sample 1 from <code>x</code></p></div></div><a class="source-link" target="_blank" href="https://github.com/zenna/Omega.jl/blob/3d525c4814c9a035ad470e1e252c428b08b91636/src/inference/rand.jl#L18">source</a><div><div><p><code>n</code> samples from <code>x</code> with rejection sampling</p></div></div><a class="source-link" target="_blank" href="https://github.com/zenna/Omega.jl/blob/3d525c4814c9a035ad470e1e252c428b08b91636/src/inference/rs.jl#L9">source</a><div><div><p>Sample <code>ω | y == true</code> with Metropolis Hasting</p></div></div><a class="source-link" target="_blank" href="https://github.com/zenna/Omega.jl/blob/3d525c4814c9a035ad470e1e252c428b08b91636/src/inference/mi.jl#L9">source</a><div><div><p>Sample from <code>x | y == true</code> with Single Site Metropolis Hasting</p></div></div><a class="source-link" target="_blank" href="https://github.com/zenna/Omega.jl/blob/3d525c4814c9a035ad470e1e252c428b08b91636/src/inference/ssmh.jl#L17">source</a><div><div><p>Sample from <code>x | y == true</code> with Hamiltonian Monte Carlo</p></div></div><a class="source-link" target="_blank" href="https://github.com/zenna/Omega.jl/blob/3d525c4814c9a035ad470e1e252c428b08b91636/src/inference/hmc.jl#L50">source</a><div><div><p>Sample from <code>x | y == true</code> with Hamiltonian Monte Carlo</p></div></div><a class="source-link" target="_blank" href="https://github.com/zenna/Omega.jl/blob/3d525c4814c9a035ad470e1e252c428b08b91636/src/inference/hmcfast.jl#L76">source</a><div><div><pre><code class="language-none">rand(s::Sampleable)</code></pre><p>Generate one sample for <code>s</code>.</p><pre><code class="language-none">rand(s::Sampleable, n::Int)</code></pre><p>Generate <code>n</code> samples from <code>s</code>. The form of the returned object depends on the variate form of <code>s</code>:</p><ul><li>When <code>s</code> is univariate, it returns a vector of length <code>n</code>.</li><li>When <code>s</code> is multivariate, it returns a matrix with <code>n</code> columns.</li><li>When <code>s</code> is matrix-variate, it returns an array, where each element is a sample matrix.</li></ul></div></div><div><div><pre><code class="language-none">rand(d::UnivariateDistribution)</code></pre><p>Generate a scalar sample from <code>d</code>. The general fallback is <code>quantile(d, rand())</code>.</p><pre><code class="language-none">rand(d::UnivariateDistribution, n::Int) -&gt; Vector</code></pre><p>Generates a vector of <code>n</code> random scalar samples from <code>d</code>. The general fallback is to pick random samples from <code>sampler(d)</code>.</p></div></div><div><div><pre><code class="language-none">rand(d::MultivariateDistribution)</code></pre><p>Sample a vector from the distribution <code>d</code>.</p><pre><code class="language-none">rand(d::MultivariateDistribution, n::Int) -&gt; Vector</code></pre><p>Sample n vectors from the distribution <code>d</code>. This returns a matrix of size <code>(dim(d), n)</code>, where each column is a sample.</p></div></div><div><div><pre><code class="language-none">rand(rng::AbstractRNG, d::AbstractMvNormal)
rand(rng::AbstractRNG, d::AbstractMvNormal, n::Int)
rand!(rng::AbstractRNG, d::AbstractMvNormal, x::AbstractArray)</code></pre><p>Sample from distribution <code>d</code> using the random number generator <code>rng</code>.</p></div></div><div><div><pre><code class="language-none">rand(d::MatrixDistribution, n)</code></pre><p>Draw a sample matrix from the distribution <code>d</code>.</p></div></div><div><div><pre><code class="language-none">rand(d::Union{UnivariateMixture, MultivariateDistribution})</code></pre><p>Draw a sample from the mixture model <code>d</code>.</p><pre><code class="language-none">rand(d::Union{UnivariateMixture, MultivariateMixture}, n)</code></pre><p>Draw <code>n</code> samples from <code>d</code>.</p></div></div></section><h2><a class="nav-anchor" id="Conditioning-with-cond-1" href="#Conditioning-with-cond-1">Conditioning with <code>cond</code></a></h2><p><code>rand(x, y)</code> is simply a shorter way of saying <code>rand(cond(x, y))</code>. That is, the primary mechanism for inference in Omega is conditioning random variables using <code>cond</code>.</p><section class="docstring"><div class="docstring-header"><a class="docstring-binding" id="Omega.cond" href="#Omega.cond"><code>Omega.cond</code></a> — <span class="docstring-category">Function</span>.</div><div><div><p>Condition random variable <code>x</code> with random predicate RandVar which returns Bool or SoftBool.</p><pre><code class="language-julia">x = normal(0.0, 1.0)
x_ = cond(x, x &gt; 0)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/zenna/Omega.jl/blob/3d525c4814c9a035ad470e1e252c428b08b91636/src/cond.jl#L4-L12">source</a><div><div><p>Condition random variable with predicate: cond(x, p) = cond(x, p(x)) <code>cond(poisson(0.5), iseven</code></p></div></div><a class="source-link" target="_blank" href="https://github.com/zenna/Omega.jl/blob/3d525c4814c9a035ad470e1e252c428b08b91636/src/cond.jl#L14-L16">source</a><div><div><p>Condition within a function</p><pre><code class="language-none">function x_(ω)
  x = 0.0
  xs = Float64[]
  while bernoulli(ω, 0.8, Bool)
    x += uniform(ω, -5.0, 5.0)
    cond(ω, x &lt;=ₛ 1.0)
    cond(ω, x &gt;=ₛ -1.0)
    push!(xs, x)
  end
  xs
end

x = ciid(x_)
samples = rand(x, 100; alg = SSMH)</code></pre></div></div><a class="source-link" target="_blank" href="https://github.com/zenna/Omega.jl/blob/3d525c4814c9a035ad470e1e252c428b08b91636/src/cond.jl#L18-L37">source</a></section><h2><a class="nav-anchor" id="Conditioning-the-Prior-1" href="#Conditioning-the-Prior-1">Conditioning the Prior</a></h2><p>In Bayesian inference the term posterior distribution is often used instead of conditional distribution.  Mathematically they are the same objec, but posterior alludes to the fact that it is the distribution after (post) observing data. Prior to observing data, your distribution is the prior.</p><p>However, conditioning is a more general concept than observing data, and we can meaningfully &quot;condition the prior&quot;.</p><p>For example we can make a truncated normal distribution with:</p><pre><code class="language-julia">x = normal(0.0, 1.0)
x_ = cond(x, x &gt; 0.0)</code></pre><p>A shorter way to write this is to pass a unary function as the second argument to <code>cond</code></p><pre><code class="language-julia">x = cond(normal(0.0, 1.0), rv -&gt; rv &gt; 0.0)</code></pre><p>Or suppose we want a poisson distribution over the even numbers</p><pre><code class="language-julia">cond(poission(1.0), iseven)</code></pre><h2><a class="nav-anchor" id="Conditions-Propagate-1" href="#Conditions-Propagate-1">Conditions Propagate</a></h2><p>When you compose condiitoned random variables together, their conditions propagate.  That is, if <code>x</code> is conditioned, and <code>y</code> is conditioned, and <code>z</code> depends on <code>x</code> and <code>y</code>, then <code>z</code> inherits all the conditions of <code>x</code> and <code>y</code> automatically.  For example:</p><pre><code class="language-julia">ispos(x) = x &gt; 0.0
weight = cond(normal(72, 1.0), ispos)
height = cond(normal(1.78, 1.0), ispos)
bmi = weight / height</code></pre><p><code>bmi</code> is a function of both <code>weight</code> and <code>height</code>, both of which have their own conditions (namely, they are positive). Omega automatically propagates the conditions from <code>weight</code> and <code>height</code> onto <code>bmi</code> respects these conditions.</p><footer><hr/><a class="previous" href="conditionalindependence.html"><span class="direction">Previous</span><span class="title">(Conditional) Independence</span></a><a class="next" href="soft.html"><span class="direction">Next</span><span class="title">Soft Execution</span></a></footer></article></body></html>
